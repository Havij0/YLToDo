<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Todo App – v0.9.1</title>
<style>
*{box-sizing:border-box}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;background:#f2f2f7}.hidden{display:none}header{position:fixed;top:0;left:0;right:0;height:56px;background:#fff;border-bottom:1px solid #ddd;display:flex;align-items:center;justify-content:space-between;padding:0 16px;z-index:20}.title{font-size:20px;font-weight:700}.version{font-size:12px;color:#888}#tabBar{position:fixed;top:56px;left:0;right:0;height:44px;display:flex;background:#fff;border-bottom:1px solid #ddd;z-index:20}.tab{flex:1;text-align:center;line-height:44px;cursor:pointer;font-weight:600;color:#666}.tab.active{color:#000;border-bottom:2px solid #000}#content{padding-top:102px;padding-bottom:120px;overflow-y:auto;position:relative}.task{background:#fff;margin:10px 12px;border-radius:16px;overflow:hidden;position:relative}.task.done{opacity:.45}.task-row{display:flex;align-items:center;min-height:52px;padding:0 14px;background:#fff;position:relative;z-index:2;transition:transform .25s ease,opacity .25s ease;touch-action:pan-y}.task-left{width:36px}.task-middle{flex:1;min-width:0}.task-right{width:20px}.task-title{font-size:16px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer}.dot{width:10px;height:10px;border-radius:50%}.swipe-bg{position:absolute;inset:0;display:flex;justify-content:flex-end;align-items:center;padding-right:10px;background:#f2f2f7;z-index:1}.swipe-btn{width:44px;height:44px;border-radius:14px;display:flex;align-items:center;justify-content:center;margin-left:8px;color:#fff;font-size:18px}#addBar{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #ddd;padding:10px 12px;display:flex;gap:8px;z-index:20}#addBar input,#addBar select{flex:1;font-size:16px;padding:12px;border-radius:14px;border:1px solid #ccc}#addBar button{padding:0 18px;font-size:22px;border-radius:14px;border:none;background:#000;color:#fff}#advAddTask{position:fixed;left:0;right:0;bottom:0;max-height:90%;overflow-y:auto;background:#fff;border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 -3px 10px rgba(0,0,0,.15);transform:translateY(100%);transition:transform .3s ease;z-index:30;padding:16px;touch-action:none}#advAddTask .handle{width:40px;height:4px;background:#ccc;border-radius:2px;margin:0 auto 12px}#details{position:fixed;inset:0;background:#f2f2f7;z-index:50;overflow-y:auto}#details .spacer{height:72px}.section{background:#fff;margin:12px;padding:12px 16px;border-radius:16px}.section h3{margin:0 0 8px;font-size:13px;color:#666}.read{font-size:16px}input,textarea,select{width:100%;font-size:16px;padding:10px;border-radius:12px;border:1px solid #ccc}input[type="date"]{height:40px;padding:8px}textarea{resize:none}.subtask{display:flex;align-items:center;gap:8px;margin-bottom:8px}.subtask input{width:20px;height:20px}.subtask .text{flex:1}#deleteBtn{margin:16px 12px;padding:14px;font-size:16px;border-radius:16px;background:#ff3b30;color:#fff;border:none}.timestamps{margin:0 12px 24px;font-size:12px;color:#888}.agenda-date{margin:12px 12px 4px;font-weight:600;font-size:14px;color:#333}#reschedulePopup{position:fixed;inset:0;background:rgba(0,0,0,.3);display:flex;align-items:center;justify-content:center;z-index:60}.reschedule-content{background:#fff;border-radius:16px;padding:16px;width:80%;max-width:320px;display:flex;flex-direction:column;gap:8px}.reschedule-content button{padding:12px;border-radius:12px;border:none;background:#007aff;color:#fff;font-weight:600}</style>
</head>
<body>

<header>
  <div class="title">Todo App</div>
  <div class="version">v0.9.1</div>
</header>

<div id="tabBar">
  <div class="tab active" data-tab="today">Today</div>
  <div class="tab" data-tab="unscheduled">To Be Scheduled</div>
  <div class="tab" data-tab="agenda">Agenda</div>
</div>

<div id="content"><div id="tasks"></div></div>

<div id="addBar">
  <input id="newTitle" placeholder="New task…" />
  <select id="newPriority">
    <option value="3">Normal</option>
    <option value="2">Important</option>
    <option value="1">Must</option>
  </select>
  <button onclick="addTask()">+</button>
  <button onclick="openAdvancedAdd()">⋁</button>
</div>

<!-- ADVANCED ADD TASK -->
<div id="advAddTask">
  <div class="handle"></div>
  <h3>Advanced Add Task</h3>
  <div class="section"><input id="advTitle" placeholder="Task title" /></div>
  <div class="section"><textarea id="advDesc" placeholder="Description" rows="3"></textarea></div>
  <div class="section"><select id="advPriority">
    <option value="3">Normal</option>
    <option value="2">Important</option>
    <option value="1">Must</option>
  </select></div>
  <div class="section"><textarea id="advSubtasks" placeholder="Subtasks, one per line" rows="3"></textarea></div>
  <div class="section"><label>Scheduled Date:</label><input type="date" id="advDate" /></div>
  <button onclick="addAdvancedTask()">Add Task</button>
  <button onclick="closeAdvancedAdd()">Cancel</button>
</div>

<!-- DETAILS -->
<div id="details" class="hidden">
  <header>
    <button onclick="closeDetails()">← Back</button>
    <button id="editBtn" onclick="toggleEdit()">Edit</button>
  </header>
  <div class="spacer"></div>
  <div class="section"><h3>Title</h3><div id="vTitle" class="read"></div><input id="eTitle" class="hidden"></div>
  <div class="section hidden" id="secDesc"><h3>Description</h3><div id="vDesc" class="read"></div><textarea id="eDesc" class="hidden" rows="3"></textarea></div>
  <div class="section hidden" id="secSubs"><h3>Subtasks</h3><div id="subtasks"></div><textarea id="subInput" class="hidden" placeholder="One subtask per line"></textarea><button id="addSubBtn" class="hidden" onclick="addSubtasks()">+ Add subtasks</button></div>
  <div class="section" id="secDate"><h3>Scheduled Date</h3><input type="date" id="eDate" class="hidden"><div id="vDate" class="read"></div></div>
  <button id="deleteBtn" class="hidden" onclick="deleteTask()">Delete task</button>
  <div class="timestamps" id="timestamps"></div>
</div>

<!-- RESCHEDULE POPUP -->
<div id="reschedulePopup" class="hidden">
  <div class="reschedule-content">
    <button onclick="rescheduleTask('tomorrow')">Tomorrow</button>
    <button onclick="rescheduleTask('nextWeek')">Next Week</button>
    <input type="date" id="rescheduleDate">
    <button onclick="confirmReschedule()">Confirm</button>
    <button onclick="closeReschedule()">Cancel</button>
  </div>
</div>

<script>
/* Full JS with fixed swipe/pull/agenda as provided previously */
</script>

</body>
</html>